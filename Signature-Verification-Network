{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.mlab as mlab\n",
    "import cv2\n",
    "import math\n",
    "import tensorflow as tf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# height and width of images\n",
    "img_width,img_height = 150,150  \n",
    "#increasing these variables increases quality and size of image\n",
    "dim = (img_width, img_height)\n",
    "\n",
    "# location of locally saved dataset\n",
    "loc= \"E:/Code data/Signatures/Dataset_Signature_Final/Dataset/\"\n",
    "\n",
    "# helper function to return black and white image ndarray on giving location\n",
    "def returnimages(path,img):\n",
    "    image=cv2.imread(path+\"/\"+ img)                  #bringing the image\n",
    "    image=cv2.resize(image, (img_width, img_height))\n",
    "    image=cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n",
    "    image = image/255\n",
    "    return image\n",
    "\n",
    "def flatten(img):return img.reshape((img.size, 1))   # flatten numpy array of floats to 1d "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.image.AxesImage at 0x1d672f17d08>"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "testimage = returnimages(loc+'dataset1/forge',\"02100002.png\")\n",
    "plt.imshow(testimage,'gray')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# real signatures 1d array\n",
    "real_sign = np.ndarray((210,img_width*img_height,1))\n",
    "forged_sign = np.ndarray((210,img_width*img_height,1))\n",
    "count_real =0\n",
    "count_forged = 0\n",
    "# importing 60 real signatures from dataset1\n",
    "for i in range(1,13):\n",
    "    for j in range(0,5):\n",
    "        fird = str(i)\n",
    "        if len(fird)== 1: fird='0'+fird\n",
    "        temp_img = returnimages(loc+'dataset1/real','0'+fird+'0'+str(j)+'0'+fird+'.png')\n",
    "        real_sign[count_real] = flatten(temp_img)\n",
    "        count_real+=1\n",
    "        #plt.imshow(temp_img,'gray')\n",
    "        #plt.show()\n",
    "\n",
    "# importing 60 forged signatures from dataset1\n",
    "for i in range(1,13):\n",
    "    for j in range(0,5):\n",
    "        fird = '0210'+str(j)\n",
    "        lastd = str(i)\n",
    "        if len(lastd)== 1: lastd='0'+lastd\n",
    "        temp_img = returnimages(loc+'dataset1/forge',fird+'0'+lastd+'.png')\n",
    "        forged_sign[count_forged] = flatten(temp_img)\n",
    "        count_forged+=1\n",
    "        #plt.imshow(temp_img,'gray')\n",
    "        #plt.show()\n",
    "\n",
    "# importing 150 real signatures from dataset2\n",
    "for i in range(1,31):\n",
    "    for j in range(1,6):\n",
    "        fird = str(i)\n",
    "        if len(fird)== 1: fird='0'+fird\n",
    "        temp_img = returnimages(loc+'dataset3/real','0'+fird+'0'+str(j)+'0'+fird+'.png')\n",
    "        real_sign[count_real] = flatten(temp_img)\n",
    "        count_real+=1\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[0.97254902],\n",
       "       [0.97254902],\n",
       "       [0.97254902],\n",
       "       ...,\n",
       "       [0.97647059],\n",
       "       [0.97647059],\n",
       "       [0.97647059]])"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "real_sign[59]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "input_var = np.ndarray((1341,2*img_width*img_height))\n",
    "output_var = np.zeros((1341,1))\n",
    "output_var[0:252]=1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def findsubs1(x): # set of elements of i to i+5\n",
    "    lis = []\n",
    "    for i in range(x,x+6):\n",
    "        for j in range(i+1,x+5):\n",
    "            lis.append([i,j])\n",
    "    return lis\n",
    "\n",
    "def findsubs2(x): # set of elements of i,i+5...\n",
    "    lis = []\n",
    "    for i in range(x,210,5):\n",
    "        for j in range(i+5,210,5):\n",
    "            lis.append([i,j])\n",
    "    return lis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "counter = 0\n",
    "for i in range(0,210,5):\n",
    "    tmp = findsubs1(i)\n",
    "    for j in tmp:\n",
    "        input_var[counter] = np.append(real_sign[j[0]],real_sign[j[1]])\n",
    "        counter+=1\n",
    "temp = findsubs2(0)\n",
    "\n",
    "for i in temp: # real - other real\n",
    "    input_var[counter] = np.append(real_sign[i[0]],real_sign[i[1]])\n",
    "    counter+=1\n",
    "    \n",
    "for i in range(0,60): # real - forged\n",
    "    input_var[counter] = np.append(real_sign[i],forged_sign[i])\n",
    "    counter+=1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1341 1341\n"
     ]
    }
   ],
   "source": [
    "print(len(input_var),len(output_var))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "train_X = np.ndarray((1341,300,150,1))\n",
    "for i in range(0,1341):\n",
    "    train_X[i] = np.reshape(input_var[i],(300,150,1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"sequential\"\n",
      "_________________________________________________________________\n",
      "Layer (type)                 Output Shape              Param #   \n",
      "=================================================================\n",
      "conv2d (Conv2D)              (None, 298, 148, 64)      640       \n",
      "_________________________________________________________________\n",
      "max_pooling2d (MaxPooling2D) (None, 99, 49, 64)        0         \n",
      "_________________________________________________________________\n",
      "conv2d_1 (Conv2D)            (None, 97, 47, 32)        18464     \n",
      "_________________________________________________________________\n",
      "max_pooling2d_1 (MaxPooling2 (None, 48, 23, 32)        0         \n",
      "_________________________________________________________________\n",
      "conv2d_2 (Conv2D)            (None, 46, 21, 16)        4624      \n",
      "_________________________________________________________________\n",
      "max_pooling2d_2 (MaxPooling2 (None, 23, 10, 16)        0         \n",
      "_________________________________________________________________\n",
      "flatten (Flatten)            (None, 3680)              0         \n",
      "_________________________________________________________________\n",
      "dense (Dense)                (None, 800)               2944800   \n",
      "_________________________________________________________________\n",
      "dense_1 (Dense)              (None, 300)               240300    \n",
      "_________________________________________________________________\n",
      "dense_2 (Dense)              (None, 1)                 301       \n",
      "=================================================================\n",
      "Total params: 3,209,129\n",
      "Trainable params: 3,209,129\n",
      "Non-trainable params: 0\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "model = tf.keras.models.Sequential([\n",
    "  tf.keras.layers.Conv2D(64, (3,3), activation='relu', input_shape=(300,150,1)),\n",
    "  tf.keras.layers.MaxPooling2D(3, 3),\n",
    "  tf.keras.layers.Conv2D(32, (3,3), activation='relu'),\n",
    "  tf.keras.layers.MaxPooling2D(2,2),\n",
    "  tf.keras.layers.Conv2D(16, (3,3), activation='relu'),\n",
    "  tf.keras.layers.MaxPooling2D(2,2),  \n",
    "  tf.keras.layers.Flatten(),\n",
    " #tf.keras.layers.Dense(1000, activation='relu'),\n",
    "  tf.keras.layers.Dense(800, activation='relu'),\n",
    "  \n",
    "  tf.keras.layers.Dense(300, activation='relu'),\n",
    "  tf.keras.layers.Dense(1, activation='sigmoid')\n",
    "])\n",
    "model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\n",
    "model.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train on 1072 samples, validate on 269 samples\n",
      "Epoch 1/15\n",
      "1072/1072 [==============================] - 16s 15ms/sample - loss: 0.5761 - accuracy: 0.7649 - val_loss: 0.2325 - val_accuracy: 1.0000\n",
      "Epoch 2/15\n",
      "1072/1072 [==============================] - 19s 18ms/sample - loss: 0.5592 - accuracy: 0.7649 - val_loss: 0.2186 - val_accuracy: 1.0000\n",
      "Epoch 3/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.5257 - accuracy: 0.7752 - val_loss: 0.1606 - val_accuracy: 1.0000\n",
      "Epoch 4/15\n",
      "1072/1072 [==============================] - 23s 21ms/sample - loss: 0.4199 - accuracy: 0.8125 - val_loss: 0.1685 - val_accuracy: 1.0000\n",
      "Epoch 5/15\n",
      "1072/1072 [==============================] - 23s 21ms/sample - loss: 0.3577 - accuracy: 0.8349 - val_loss: 0.6784 - val_accuracy: 0.6580\n",
      "Epoch 6/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.3953 - accuracy: 0.8144 - val_loss: 0.3366 - val_accuracy: 0.9926\n",
      "Epoch 7/15\n",
      "1072/1072 [==============================] - 23s 21ms/sample - loss: 0.3503 - accuracy: 0.8396 - val_loss: 0.2935 - val_accuracy: 0.9926\n",
      "Epoch 8/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.3533 - accuracy: 0.8274 - val_loss: 0.2423 - val_accuracy: 1.0000\n",
      "Epoch 9/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.3650 - accuracy: 0.8377 - val_loss: 0.2857 - val_accuracy: 0.9926\n",
      "Epoch 10/15\n",
      "1072/1072 [==============================] - 23s 21ms/sample - loss: 0.3238 - accuracy: 0.8368 - val_loss: 0.1539 - val_accuracy: 1.0000\n",
      "Epoch 11/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.2904 - accuracy: 0.8414 - val_loss: 0.1564 - val_accuracy: 0.9442\n",
      "Epoch 12/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.2428 - accuracy: 0.8741 - val_loss: 0.1103 - val_accuracy: 0.9442\n",
      "Epoch 13/15\n",
      "1072/1072 [==============================] - 22s 21ms/sample - loss: 0.2319 - accuracy: 0.8825 - val_loss: 0.2081 - val_accuracy: 0.8959\n",
      "Epoch 14/15\n",
      "1072/1072 [==============================] - 31s 29ms/sample - loss: 0.1885 - accuracy: 0.9049 - val_loss: 0.3614 - val_accuracy: 0.9145\n",
      "Epoch 15/15\n",
      "1072/1072 [==============================] - 23s 21ms/sample - loss: 0.2627 - accuracy: 0.8955 - val_loss: 0.1365 - val_accuracy: 0.9517\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<tensorflow.python.keras.callbacks.History at 0x1d6783d7948>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model.fit(train_X, output_var,validation_split=0.2, epochs=15)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "tensorflow-GPU",
   "language": "python",
   "name": "tensorflow"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
